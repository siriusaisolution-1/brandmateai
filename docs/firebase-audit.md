# Firebase audit â€“ Library, Requests & Calendar

## Collections

- `contentRequests`
  - Read-only from clients (rules restrict write).
  - Used by `/brands/[brandId]/requests` page to list campaigns per brand.
- `outputs`
  - Read-only for brand owners. Generated by backend agents; surfaced in `/brands/[brandId]/library`.
- `calendarEvents`
  - Read/write for owner via existing rules. Displayed in `/brands/[brandId]/calendar` as a read-only month view.

## Security rules summary

- `contentRequests` and `outputs` are guarded by `isBrandOwner(resource.data.brandId)` for reads; writes are blocked for clients.
- `calendarEvents` continues to require `ownerId` to match `request.auth.uid` for reads/writes.

## Frontend touchpoints

- Hooks in `src/hooks/brand-content.ts` issue Firestore queries via ReactFire.
- UI routes:
  - `src/app/(app)/brands/[brandId]/library/page.tsx`
  - `src/app/(app)/brands/[brandId]/requests/page.tsx`
  - `src/app/(app)/brands/[brandId]/calendar/page.tsx`
- Testing notes:
  - Firestore rules check script now skips when the emulator host is missing and uses `demo-project` for isolated runs.
  - Vitest aliases Google GenAI imports to a local shim to avoid external network requirements during unit tests.
